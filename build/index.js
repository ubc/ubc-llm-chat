(()=>{"use strict";var e,l={683:(e,l,a)=>{const t=window.wp.blocks,s=window.wp.i18n,c=window.wp.blockEditor,r=window.wp.components,n=window.wp.element,o=window.wp.apiFetch;var i=a.n(o);const m=window.ReactJSXRuntime;(0,t.registerBlockType)("ubc-llm-chat/chat",{apiVersion:2,title:(0,s.__)("UBC LLM Chat","ubc-llm-chat"),description:(0,s.__)("Add an LLM chat interface to your page.","ubc-llm-chat"),category:"widgets",icon:"format-chat",keywords:["chat","ai","llm","chatgpt","ollama"],supports:{html:!1,customClassName:!0},attributes:{llmservice:{type:"string",default:""},llm:{type:"string",default:""},minimum_user_role:{type:"string",default:""},maxmessages:{type:"number",default:20},maxconversations:{type:"number",default:10},systemprompt:{type:"string",default:""},temperature:{type:"number",default:.7},debug_mode:{type:"boolean",default:!1}},edit:({attributes:e,setAttributes:l})=>{const a=(0,c.useBlockProps)({className:"ubc-llm-chat-block-editor"}),[t,o]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[b,d]=(0,n.useState)(null);(0,n.useEffect)((()=>{h(!0),i()({path:"/ubc-llm-chat/v1/settings"}).then((e=>{o(e),h(!1)})).catch((e=>{console.error("Error fetching UBC LLM Chat settings:",e),d((0,s.__)("Could not load settings. Please check the console for errors.","ubc-llm-chat")),h(!1)}))}),[]);const _=[{label:(0,s.__)("Default (from settings)","ubc-llm-chat"),value:""},{label:(0,s.__)("Subscriber","ubc-llm-chat"),value:"subscriber"},{label:(0,s.__)("Contributor","ubc-llm-chat"),value:"contributor"},{label:(0,s.__)("Author","ubc-llm-chat"),value:"author"},{label:(0,s.__)("Editor","ubc-llm-chat"),value:"editor"},{label:(0,s.__)("Administrator","ubc-llm-chat"),value:"administrator"}];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c.InspectorControls,{children:[(0,m.jsx)(r.PanelBody,{title:(0,s.__)("LLM Settings","ubc-llm-chat"),initialOpen:!0,children:u?(0,m.jsxs)("div",{className:"ubc-llm-chat-loading",children:[(0,m.jsx)(r.Spinner,{}),(0,m.jsx)("p",{children:(0,s.__)("Loading settings...","ubc-llm-chat")})]}):b?(0,m.jsx)("div",{className:"ubc-llm-chat-error",children:(0,m.jsx)("p",{children:b})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(r.SelectControl,{label:(0,s.__)("LLM Service","ubc-llm-chat"),value:e.llmservice,options:(()=>{if(!t)return[{label:(0,s.__)("Loading...","ubc-llm-chat"),value:""}];const e=[{label:(0,s.__)("Default (from settings)","ubc-llm-chat"),value:""}];return t.services&&(t.services.openai&&t.services.openai.enabled&&e.push({label:(0,s.__)("OpenAI","ubc-llm-chat"),value:"openai"}),t.services.ollama&&t.services.ollama.enabled&&e.push({label:(0,s.__)("Ollama","ubc-llm-chat"),value:"ollama"})),e})(),onChange:e=>{l({llmservice:e,llm:""})},help:(0,s.__)("Select the LLM service to use. Only enabled services are shown.","ubc-llm-chat")}),(0,m.jsx)(r.SelectControl,{label:(0,s.__)("LLM Model","ubc-llm-chat"),value:e.llm,options:(()=>{if(!t||!e.llmservice)return[{label:(0,s.__)("Default (from settings)","ubc-llm-chat"),value:""}];const l=[{label:(0,s.__)("Default (from settings)","ubc-llm-chat"),value:""}];if("openai"===e.llmservice&&t.services?.openai?.models){const e=t.services.openai.models;Array.isArray(e)&&e.length>0?e.forEach((e=>{l.push({label:e,value:e})})):l.push({label:(0,s.__)("No models available","ubc-llm-chat"),value:"",disabled:!0})}else if("ollama"===e.llmservice&&t.services?.ollama?.models){const e=t.services.ollama.models;Array.isArray(e)&&e.length>0?e.forEach((e=>{l.push({label:e,value:e})})):l.push({label:(0,s.__)("No models available","ubc-llm-chat"),value:"",disabled:!0})}return l})(),onChange:e=>l({llm:e}),help:(0,s.__)("Select the LLM model to use. Only available models for the selected service are shown.","ubc-llm-chat"),disabled:!e.llmservice}),(0,m.jsx)(r.RangeControl,{label:(0,s.__)("Temperature","ubc-llm-chat"),value:e.temperature,onChange:e=>l({temperature:e}),min:0,max:2,step:.1,help:(0,s.__)("Controls randomness: 0 is deterministic, higher values are more creative.","ubc-llm-chat")}),(0,m.jsx)(r.TextareaControl,{label:(0,s.__)("System Prompt","ubc-llm-chat"),value:e.systemprompt,onChange:e=>l({systemprompt:e}),help:(0,s.__)("Set a system prompt for the LLM.","ubc-llm-chat")})]})}),(0,m.jsxs)(r.PanelBody,{title:(0,s.__)("User Settings","ubc-llm-chat"),initialOpen:!1,children:[(0,m.jsx)(r.SelectControl,{label:(0,s.__)("Minimum User Role","ubc-llm-chat"),value:e.minimum_user_role,options:_,onChange:e=>l({minimum_user_role:e}),help:(0,s.__)("Minimum user role required to use the chat.","ubc-llm-chat")}),(0,m.jsx)(r.RangeControl,{label:(0,s.__)("Max Messages Per Conversation","ubc-llm-chat"),value:e.maxmessages,onChange:e=>l({maxmessages:e}),min:1,max:100,step:1,help:(0,s.__)("Maximum number of messages allowed in a single conversation.","ubc-llm-chat")}),(0,m.jsx)(r.RangeControl,{label:(0,s.__)("Max Conversations","ubc-llm-chat"),value:e.maxconversations,onChange:e=>l({maxconversations:e}),min:1,max:50,step:1,help:(0,s.__)("Maximum number of conversations a user can have.","ubc-llm-chat")})]})]}),(0,m.jsx)(c.InspectorControls,{group:"advanced",children:(0,m.jsx)(r.ToggleControl,{label:(0,s.__)("Debug Mode","ubc-llm-chat"),checked:e.debug_mode,onChange:e=>l({debug_mode:e}),help:(0,s.__)("Enable debug mode to see additional information in the console.","ubc-llm-chat")})}),(0,m.jsx)("div",{...a,children:u?(0,m.jsxs)("div",{className:"ubc-llm-chat-block-loading",children:[(0,m.jsx)(r.Spinner,{}),(0,m.jsx)("p",{children:(0,s.__)("Loading LLM chat settings...","ubc-llm-chat")})]}):b?(0,m.jsx)("div",{className:"ubc-llm-chat-block-error",children:(0,m.jsx)("p",{children:b})}):(0,m.jsxs)("div",{className:"ubc-llm-chat-block-preview",children:[(0,m.jsx)("div",{className:"ubc-llm-chat-block-title",children:(0,s.__)("UBC LLM Chat","ubc-llm-chat")}),(0,m.jsx)("div",{className:"ubc-llm-chat-block-description",children:(0,s.__)("This block will display a chat interface on the front end.","ubc-llm-chat")}),(0,m.jsxs)("div",{className:"ubc-llm-chat-block-settings",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:(0,s.__)("Service:","ubc-llm-chat")})," ",e.llmservice||(0,s.__)("Default","ubc-llm-chat")]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:(0,s.__)("Model:","ubc-llm-chat")})," ",e.llm||(0,s.__)("Default","ubc-llm-chat")]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:(0,s.__)("Temperature:","ubc-llm-chat")})," ",e.temperature]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:(0,s.__)("Max Messages:","ubc-llm-chat")})," ",e.maxmessages]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:(0,s.__)("Max Conversations:","ubc-llm-chat")})," ",e.maxconversations]})]})]})})]})},save:()=>null})}},a={};function t(e){var s=a[e];if(void 0!==s)return s.exports;var c=a[e]={exports:{}};return l[e](c,c.exports,t),c.exports}t.m=l,e=[],t.O=(l,a,s,c)=>{if(!a){var r=1/0;for(m=0;m<e.length;m++){for(var[a,s,c]=e[m],n=!0,o=0;o<a.length;o++)(!1&c||r>=c)&&Object.keys(t.O).every((e=>t.O[e](a[o])))?a.splice(o--,1):(n=!1,c<r&&(r=c));if(n){e.splice(m--,1);var i=s();void 0!==i&&(l=i)}}return l}c=c||0;for(var m=e.length;m>0&&e[m-1][2]>c;m--)e[m]=e[m-1];e[m]=[a,s,c]},t.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return t.d(l,{a:l}),l},t.d=(e,l)=>{for(var a in l)t.o(l,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:l[a]})},t.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),(()=>{var e={57:0,350:0};t.O.j=l=>0===e[l];var l=(l,a)=>{var s,c,[r,n,o]=a,i=0;if(r.some((l=>0!==e[l]))){for(s in n)t.o(n,s)&&(t.m[s]=n[s]);if(o)var m=o(t)}for(l&&l(a);i<r.length;i++)c=r[i],t.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return t.O(m)},a=globalThis.webpackChunkubc_llm_chat=globalThis.webpackChunkubc_llm_chat||[];a.forEach(l.bind(null,0)),a.push=l.bind(null,a.push.bind(a))})();var s=t.O(void 0,[350],(()=>t(683)));s=t.O(s)})();