(()=>{"use strict";var e,l={683:(e,l,a)=>{const s=window.wp.blocks,c=window.wp.i18n,t=window.wp.blockEditor,r=window.wp.components,i=window.wp.element,n=window.wp.apiFetch;var m=a.n(n);const o=window.ReactJSXRuntime;(0,s.registerBlockType)("ubc-llm-chat/chat",{apiVersion:2,title:(0,c.__)("UBC LLM Chat","ubc-llm-chat"),description:(0,c.__)("Add an LLM chat interface to your page.","ubc-llm-chat"),category:"widgets",icon:"format-chat",keywords:["chat","ai","llm","chatgpt","ollama"],supports:{html:!1,customClassName:!0},attributes:{llmservice:{type:"string",default:""},llm:{type:"string",default:""},minimum_user_role:{type:"string",default:""},maxmessages:{type:"number",default:20},maxconversations:{type:"number",default:10},systemprompt:{type:"string",default:""},temperature:{type:"number",default:.7},debug_mode:{type:"boolean",default:!1}},edit:({attributes:e,setAttributes:l})=>{const a=(0,t.useBlockProps)({className:"ubc-llm-chat-block-editor"}),[s,n]=(0,i.useState)(null),[u,h]=(0,i.useState)(!0),[d,b]=(0,i.useState)(null);(0,i.useEffect)((()=>{h(!0),m()({path:"/ubc-llm-chat/v1/settings"}).then((e=>{n(e),h(!1)})).catch((e=>{console.error("Error fetching UBC LLM Chat settings:",e),b((0,c.__)("Could not load settings. Please check the console for errors.","ubc-llm-chat")),h(!1)}))}),[]);const v=[{label:(0,c.__)("Default (from settings)","ubc-llm-chat"),value:""},{label:(0,c.__)("Subscriber","ubc-llm-chat"),value:"subscriber"},{label:(0,c.__)("Contributor","ubc-llm-chat"),value:"contributor"},{label:(0,c.__)("Author","ubc-llm-chat"),value:"author"},{label:(0,c.__)("Editor","ubc-llm-chat"),value:"editor"},{label:(0,c.__)("Administrator","ubc-llm-chat"),value:"administrator"}];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.InspectorControls,{children:[(0,o.jsx)(r.PanelBody,{title:(0,c.__)("LLM Settings","ubc-llm-chat"),initialOpen:!0,children:u?(0,o.jsxs)("div",{className:"ubc-llm-chat-loading",children:[(0,o.jsx)(r.Spinner,{}),(0,o.jsx)("p",{children:(0,c.__)("Loading settings...","ubc-llm-chat")})]}):d?(0,o.jsx)("div",{className:"ubc-llm-chat-error",children:(0,o.jsx)("p",{children:d})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.SelectControl,{label:(0,c.__)("LLM Service","ubc-llm-chat"),value:e.llmservice,options:(()=>{if(!s)return[{label:(0,c.__)("Loading...","ubc-llm-chat"),value:""}];const e=[{label:(0,c.__)("Default (from settings)","ubc-llm-chat"),value:""}];return s.services&&(s.services.openai&&s.services.openai.enabled&&e.push({label:(0,c.__)("OpenAI","ubc-llm-chat"),value:"openai"}),s.services.ollama&&s.services.ollama.enabled&&e.push({label:(0,c.__)("Ollama","ubc-llm-chat"),value:"ollama"})),e})(),onChange:e=>{l({llmservice:e,llm:""})},help:(0,c.__)("Select the LLM service to use. Only enabled services are shown.","ubc-llm-chat")}),(0,o.jsx)(r.SelectControl,{label:(0,c.__)("LLM Model","ubc-llm-chat"),value:e.llm,options:(()=>{if(!s||!e.llmservice)return[{label:(0,c.__)("Default (from settings)","ubc-llm-chat"),value:""}];const l=[{label:(0,c.__)("Default (from settings)","ubc-llm-chat"),value:""}];if("openai"===e.llmservice&&s.services?.openai?.models){const e=s.services.openai.models;Array.isArray(e)&&e.length>0?e.forEach((e=>{l.push({label:e,value:e})})):l.push({label:(0,c.__)("No models available","ubc-llm-chat"),value:"",disabled:!0})}else if("ollama"===e.llmservice&&s.services?.ollama?.models){const e=s.services.ollama.models;Array.isArray(e)&&e.length>0?e.forEach((e=>{l.push({label:e,value:e})})):l.push({label:(0,c.__)("No models available","ubc-llm-chat"),value:"",disabled:!0})}return l})(),onChange:e=>l({llm:e}),help:(0,c.__)("Select the LLM model to use. Only available models for the selected service are shown.","ubc-llm-chat"),disabled:!e.llmservice}),(0,o.jsx)(r.RangeControl,{label:(0,c.__)("Temperature","ubc-llm-chat"),value:e.temperature,onChange:e=>l({temperature:e}),min:0,max:2,step:.1,help:(0,c.__)("Controls randomness: 0 is deterministic, higher values are more creative.","ubc-llm-chat")}),(0,o.jsx)(r.TextareaControl,{label:(0,c.__)("System Prompt","ubc-llm-chat"),value:e.systemprompt,onChange:e=>l({systemprompt:e}),help:(0,c.__)("Set a system prompt for the LLM.","ubc-llm-chat")})]})}),(0,o.jsxs)(r.PanelBody,{title:(0,c.__)("User Settings","ubc-llm-chat"),initialOpen:!1,children:[(0,o.jsx)(r.SelectControl,{label:(0,c.__)("Minimum User Role","ubc-llm-chat"),value:e.minimum_user_role,options:v,onChange:e=>l({minimum_user_role:e}),help:(0,c.__)("Minimum user role required to use the chat.","ubc-llm-chat")}),(0,o.jsx)(r.RangeControl,{label:(0,c.__)("Max Messages Per Conversation","ubc-llm-chat"),value:e.maxmessages,onChange:e=>l({maxmessages:e}),min:1,max:100,step:1,help:(0,c.__)("Maximum number of messages allowed in a single conversation.","ubc-llm-chat")}),(0,o.jsx)(r.RangeControl,{label:(0,c.__)("Max Conversations","ubc-llm-chat"),value:e.maxconversations,onChange:e=>l({maxconversations:e}),min:1,max:50,step:1,help:(0,c.__)("Maximum number of conversations a user can have.","ubc-llm-chat")})]})]}),(0,o.jsx)(t.InspectorControls,{group:"advanced",children:(0,o.jsx)(r.ToggleControl,{label:(0,c.__)("Debug Mode","ubc-llm-chat"),checked:e.debug_mode,onChange:e=>l({debug_mode:e}),help:(0,c.__)("Enable debug mode to see additional information in the console.","ubc-llm-chat")})}),(0,o.jsx)("div",{...a,children:u?(0,o.jsxs)("div",{className:"ubc-llm-chat-block-loading",children:[(0,o.jsx)(r.Spinner,{}),(0,o.jsx)("p",{children:(0,c.__)("Loading LLM chat settings...","ubc-llm-chat")})]}):d?(0,o.jsx)("div",{className:"ubc-llm-chat-block-error",children:(0,o.jsx)("p",{children:d})}):(0,o.jsxs)("div",{className:"ubc-llm-chat-block-preview",children:[(0,o.jsxs)("div",{className:"ubc-llm-chat-block-header",children:[(0,o.jsxs)("h3",{className:"ubc-llm-chat-block-title",children:[(0,c.__)("UBC LLM Chat","ubc-llm-chat"),e.debug_mode&&(0,o.jsx)("span",{className:"ubc-llm-chat-debug-badge",children:(0,c.__)("Debug Mode","ubc-llm-chat")})]}),(0,o.jsxs)("div",{className:"ubc-llm-chat-block-subtitle",children:[(0,o.jsx)("span",{className:"ubc-llm-chat-service",children:e.llmservice?e.llmservice.charAt(0).toUpperCase()+e.llmservice.slice(1):(0,c.__)("Default Service","ubc-llm-chat")}),e.llm&&(0,o.jsxs)("span",{className:"ubc-llm-chat-model",children:[" / ",e.llm]})]})]}),(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-container",children:[(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-sidebar",children:[(0,o.jsx)("div",{className:"ubc-llm-chat-preview-new-chat",children:(0,o.jsxs)("span",{className:"ubc-llm-chat-preview-button",children:["+ ",(0,c.__)("New Chat","ubc-llm-chat")]})}),(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-conversations",children:[(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-conversation ubc-llm-chat-preview-active",children:[(0,o.jsx)("span",{className:"ubc-llm-chat-preview-conversation-title",children:(0,c.__)("AI Background Research","ubc-llm-chat")}),(0,o.jsx)("span",{className:"ubc-llm-chat-preview-conversation-time",children:(0,c.__)("Today","ubc-llm-chat")})]}),(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-conversation",children:[(0,o.jsx)("span",{className:"ubc-llm-chat-preview-conversation-title",children:(0,c.__)("Course Planning","ubc-llm-chat")}),(0,o.jsx)("span",{className:"ubc-llm-chat-preview-conversation-time",children:(0,c.__)("Yesterday","ubc-llm-chat")})]})]})]}),(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-main",children:[(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-messages",children:[(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message ubc-llm-chat-preview-user-message",children:(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message-content",children:(0,o.jsx)("p",{children:(0,c.__)("Can you tell me about recent advancements in AI research?","ubc-llm-chat")})})}),(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message ubc-llm-chat-preview-ai-message",children:(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message-content",children:(0,o.jsx)("p",{children:(0,c.__)("Recent AI advancements include multimodal models like GPT-4o that can process text, images, and audio simultaneously...","ubc-llm-chat")})})}),(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message ubc-llm-chat-preview-user-message",children:(0,o.jsx)("div",{className:"ubc-llm-chat-preview-message-content",children:(0,o.jsx)("p",{children:(0,c.__)("How might these be applied in education?","ubc-llm-chat")})})})]}),(0,o.jsx)("div",{className:"ubc-llm-chat-preview-input-area",children:(0,o.jsxs)("div",{className:"ubc-llm-chat-preview-input",children:[(0,o.jsx)("div",{className:"ubc-llm-chat-preview-textarea",children:(0,c.__)("Type your message...","ubc-llm-chat")}),(0,o.jsx)("div",{className:"ubc-llm-chat-preview-send-button",children:"â†’"})]})})]})]}),(0,o.jsxs)("div",{className:"ubc-llm-chat-block-footer",children:[(0,o.jsxs)("div",{className:"ubc-llm-chat-block-settings-badge",children:[(0,o.jsxs)("span",{children:[(0,o.jsx)("strong",{children:(0,c.__)("Max Messages:","ubc-llm-chat")})," ",e.maxmessages]}),(0,o.jsxs)("span",{children:[(0,o.jsx)("strong",{children:(0,c.__)("Max Conversations:","ubc-llm-chat")})," ",e.maxconversations]}),(0,o.jsxs)("span",{children:[(0,o.jsx)("strong",{children:(0,c.__)("Temperature:","ubc-llm-chat")})," ",e.temperature]})]}),e.minimum_user_role&&(0,o.jsxs)("div",{className:"ubc-llm-chat-block-role-badge",children:[(0,c.__)("Minimum Role:","ubc-llm-chat")," ",e.minimum_user_role]})]})]})})]})},save:()=>null})}},a={};function s(e){var c=a[e];if(void 0!==c)return c.exports;var t=a[e]={exports:{}};return l[e](t,t.exports,s),t.exports}s.m=l,e=[],s.O=(l,a,c,t)=>{if(!a){var r=1/0;for(o=0;o<e.length;o++){for(var[a,c,t]=e[o],i=!0,n=0;n<a.length;n++)(!1&t||r>=t)&&Object.keys(s.O).every((e=>s.O[e](a[n])))?a.splice(n--,1):(i=!1,t<r&&(r=t));if(i){e.splice(o--,1);var m=c();void 0!==m&&(l=m)}}return l}t=t||0;for(var o=e.length;o>0&&e[o-1][2]>t;o--)e[o]=e[o-1];e[o]=[a,c,t]},s.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return s.d(l,{a:l}),l},s.d=(e,l)=>{for(var a in l)s.o(l,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:l[a]})},s.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),(()=>{var e={57:0,350:0};s.O.j=l=>0===e[l];var l=(l,a)=>{var c,t,[r,i,n]=a,m=0;if(r.some((l=>0!==e[l]))){for(c in i)s.o(i,c)&&(s.m[c]=i[c]);if(n)var o=n(s)}for(l&&l(a);m<r.length;m++)t=r[m],s.o(e,t)&&e[t]&&e[t][0](),e[t]=0;return s.O(o)},a=globalThis.webpackChunkubc_llm_chat=globalThis.webpackChunkubc_llm_chat||[];a.forEach(l.bind(null,0)),a.push=l.bind(null,a.push.bind(a))})();var c=s.O(void 0,[350],(()=>s(683)));c=s.O(c)})();